\section{Theory}
\label{theory}

\subsection{One-Qubit State Tomography}

In a classical computer the internal
state is measured at different points in time in order to read data, debug the
system, or perform computation. Measurement in quantum mechanics, though, only
gives us information on the state \textit{after} measuring, the act of measuring
destroys the initial state. In order to characterize quantum
states in computers, one must resort to state tomography, the process of
measuring an ensemble of states in many different bases to reconstruct the
initial state's density matrix and thus find out what state was realized
\textit{before} the measurement, rather than simply finding what the state has
collapsed to \textit{after} the measurement.
We first define the density matrix of a single
qubit,
\begin{equation}
  \rho=\frac{1}{2}\left(\mathbb{1}+\sum_{i=1}^3\alpha_i\sigma_i\right)
\end{equation}
where $\mathbb{1}$ is the 2-D identity matrix, $\sigma_i$ are all the
Pauli-matrices and $\alpha_i$ are real-valued coefficients
\cite{nielsen10_quant}. Using the trace orthogonality of the Pauli-matrices
(because the trace of an operator gives the average value of the observable),

\begin{equation} \Tr\left(\sigma_j\sigma_k\right)=2\delta_{jk}
\end{equation}
we can derive the real-valued coefficients by calculating the
expectation values of the different Pauli-matrices.
\begin{equation}
\Tr\left(\rho\sigma_i\right)=\left\langle\sigma_i\right\rangle=\alpha_i
\end{equation}
By measuring the single qubit in the different bases ($X$, $Y$ and $Z$) we can
derive these expectation values\cite{nielsen10_quant}. This requires a repeated
preparation and measurement of the final state, and in the limit of a large sample
size this reconstructed density matrix approaches the state's density matrix
$\rho_s$. In reality, the measured expectation values are estimations of
$\langle \hat{X}\rangle$, $\langle \hat{Y}\rangle$, $\left\langle
\hat{Z}\right\rangle$. Often, as in this case, in a quantum computer the
measurements are only done in the $Z$-basis. Other operators are realized using
rotation operators before the final measurement.

We wish to characterize the fidelity of the circuits without including the error
that results from measurements. To do so, we correct for readout error, which will give us a better estimation of
the density matrix $\rho_s$. If $\epsilon_{10}$, $\epsilon_{01}$ are the
probabilities that a $\ket{0}$ state returns an eigenvalue of -1 and a $\ket{1}$
state returns an eigenvalue of 1 respectively (note that this is not a quantum
effect but classical error), and if $\alpha$, $\beta$ are coefficients of the
final state $\ket{\psi}=\alpha\ket{0}+\beta\ket{1}$, then the measured
expectation value $\overline{m}$ in the $Z$-basis is
\begin{equation*}
  \begin{split}
    \overline{m} &=\left(1-\epsilon_{10}\right)\left|\alpha\right|^2
    +\epsilon_{01}\left|\beta\right|^2\\
    &-\left(1-\epsilon_{01}\right)\left|\beta\right|^2
    -\epsilon_{10}\left|\alpha\right|^2\\
    &=\left(\epsilon_{01}-\epsilon_{10}\right)
    +\left(1-\epsilon_{01}-\epsilon_{10}\right)\left(\left|\alpha\right|^2
      -\left|\beta\right|^2\right)\\
  \end{split}
\end{equation*}
Using the last line we can define the parameters $\beta_0$ and $\beta_1$,
\begin{equation}
  \begin{split}
   \overline{m}_Z =\beta_0+\beta_1\left\langle \hat{Z}\right\rangle
 \end{split}
\end{equation}
From error measurements, $\beta_0$ and $\beta_1$ are derived by measuring
different states on all relevant qubits. These estimates of $\beta_0$ and
$\beta_1$ are accurate because we know that the initialization of the states
created for the readout error measurements has a very high fidelity (99\%
accurate) and the gates used to create the final state measurements (in the case
of $\langle \hat{X}\rangle$, $\langle \hat{Y}\rangle$) are almost perfect
(fidelities exceeding 99.9\%)\cite{ibmq_burlington,
ibmq_16_melbourne, ibmq_yorktown}. From this expression, $\langle \hat{Z}\rangle$
and the other expectation values $\langle \hat{\sigma}_i\rangle$ are derived
from all the different measurements $\overline{m}_i$
\cite{QuantumStateTomography}.
\begin{equation}
\begin{split} \left\langle
\hat{\sigma}_i\right\rangle=\frac{\overline{m}_i-\beta_0}{\beta_1}
\end{split}
\end{equation}
So the final density matrix $\rho_{fin}$ is defined as:
\begin{equation}
\begin{split}
  \rho_{fin}=\frac{1}{2}\left(I+\sum_{i=1}^3\frac{\overline{m}_i
      -\beta_0}{\beta_1}\sigma_i\right)
\end{split}
\end{equation}

\subsection{Two-Qubit State Tomography}\label{two-qubit}
This procedure can be generalized to $n$-qubits:
\begin{equation}
  \rho=\sum_{\vec{v}_i}\frac{\Tr\left(\sigma_{v_1}
    \otimes\cdots\otimes\sigma_{v_n}\rho\right)\sigma_{v_1}
    \otimes\cdots\otimes\sigma_{v_n}}{2^n}
\end{equation}
where we sum over vectors $\vec{v}_i=\left(v_1,...,v_n\right)$
\cite{nielsen10_quant}. The entries can be all the different combinations of
basis. What these products of Pauli matrices mean is that we measure different
bits in various basis. Rewriting this general expression for a two qubit system
gives
\begin{equation*}
  \rho=\frac{1}{4}\sum_{\vec{v}_i}\Tr\left(\sigma_{v_1}
    \otimes\sigma_{v_2}\rho\right)\sigma_{v_1}\otimes\sigma_{v_2}
\end{equation*}
\begin{equation}
  \rho=\frac{1}{4}\sum_{\vec{v}_i}\left\langle\sigma_{v_1}
    \otimes\sigma_{v_2}\right\rangle\sigma_{v_1}\otimes\sigma_{v_2}
\end{equation}
where we sum over all the combinations of bases ($\mathbb{1}$, $X$, $Y$ and
$Z$). So in total we have fifteen coefficients which can be extracted from 9
different circuits for the basis combinations. The nine measurement bases are
the two-qubit correlations and then we have 6 expectation values containing the
identity (we do not count $\mathbb{1} \otimes \mathbb{1}$ as it contributes 1 to
the sum always). These six are the Bloch vectors of the most- and least
significant bits, and those are derived from the original measurements by
counting up all counts of the basis where there is now an identity matrix. For
example if we want to know the expectation value of $\langle XI\rangle$ we can
use three different measurement results ($\langle XX\rangle$, $\langle
XY\rangle$ and $\langle XZ\rangle$), and in this case combine the counts from
the least significant qubit.

Again we can correct for readout error, but for two-qubit systems this is a bit
more complicated. Ideally we want the measured expectation value in a particular
basis for two different qubits to coincide with the actual expectation values of
the most- and least-significant qubit and the two-qubit correlation. But the
readout is compromised by readout error and crosstalk between the qubits. As a
result of these errors the most-significant qubit (MSQ), least-significant qubit
(LSQ) and correlations results are all affected. The measured result in a
specific basis $\overline{m}_{ij}$ is related to the expectation values by
\begin{equation}
\label{beta}
\begin{split}
  \begin{pmatrix}
    \overline{m}_{ij,MSQ} \\ \overline{m}_{ij,LSQ} \\ \overline{m}_{ij,corr}
  \end{pmatrix} =
  \begin{pmatrix}
    \beta_{0,M} \\ \beta_{0,L} \\ \beta_{0,corr}
  \end{pmatrix} + \\
  \begin{pmatrix}
    \beta_{1,M}&\beta_{2,M}&\beta_{3,M} \\
    \beta_{1,L}&\beta_{2,L}&\beta_{3,L} \\
    \beta_{1,corr}&\beta_{2,corr}&\beta_{3,corr}
  \end{pmatrix}
  \begin{pmatrix}
    \left\langle I\sigma_j\right\rangle \\ \left\langle
      \sigma_iI\right\rangle \\ \left\langle \sigma_i\sigma_j\right\rangle
  \end{pmatrix}
\end{split}
\end{equation}
rather than the two parameters $\beta_0$ and $\beta_1$, we now have a 3x3
matrix $B$ and an offset vector of $\beta$ values for the MSQ, LSQ, and
correlations. 

These parameters give the following correction to the expectation values
\begin{equation}
\begin{split}
  \begin{pmatrix}
    \left\langle I\sigma_j\right\rangle_{est} \\ \left\langle
      \sigma_iI\right\rangle_{est} \\ \left\langle \sigma_i\sigma_j\right\rangle_{est}
  \end{pmatrix}
  = B^{-1}\left(
    \begin{pmatrix}
      \overline{m}_{ij,MSQ} \\ \overline{m}_{ij,LSQ} \\ \overline{m}_{ij,corr}
    \end{pmatrix}
    -
    \begin{pmatrix}
      \beta_{0,M} \\ \beta_{0,L} \\ \beta_{0,corr}
    \end{pmatrix}\right)
\end{split}
\end{equation}
Four calibration circuits are required to determine all the parameters in $B$
and in the vector $\vec{\beta}$. Each one initializes the state of the two qubits in
$\ket{00}$, $\ket{01}$, $\ket{10}$, and $\ket{11}$. And each of these
four initial states give us a part of what is needed to construct $B$ and
$\vec{\beta}$, from the equation
\begin{equation}
  \begin{pmatrix}
    \overline{m}_{A,k} \\ \overline{m}_{B,k} \\ \overline{m}_{C,k}
    \\ \overline{m}_{D,k}
  \end{pmatrix} =
  \begin{pmatrix}
    1&1&1&1\\
    1&1&-1&-1\\
    1&-1&1&-1\\
    1&-1&-1&1
  \end{pmatrix}
  \begin{pmatrix}
    \beta_{0,k} \\ \beta_{1,k} \\ \beta_{2,k} \\ \beta_{3,k}
  \end{pmatrix}
\end{equation}
where $k$ can be MSQ, LSQ or correlated and the matrix is called
$M_k$. These relations are derived from formula \ref{beta}, where the expectation
values are either 1 or -1 depending on the type of circuit. Finally we express
the beta's in terms of these calibration results \cite{QuantumStateTomography}:

\begin{equation}
  \begin{pmatrix}
    \beta_{0,k} \\ \beta_{1,k} \\ \beta_{2,k} \\ \beta_{3,k}
  \end{pmatrix} = M_k^{-1}
  \begin{pmatrix}
    \overline{m}_{A,k} \\ \overline{m}_{B,k} \\ \overline{m}_{C,k}
    \\ \overline{m}_{D,k}
  \end{pmatrix}.
\end{equation}
With these values, we can correct for the error accrued when performing state
measurement, and determine the two-qubit states that our circuits actually
produce, rather than the states that we see when we naively combine circuit and
measurement errors. This is a particularly important task to perform.
Superconducting qubits have in general very high fidelity single gate
operations, and likewise near perfect initialization, so a main source of error
is in fact from measurement. Without correcting for this error a true
characterization of the circuits would not be possible, as any output fidelity
would be massively depressed.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "report"
%%% End: